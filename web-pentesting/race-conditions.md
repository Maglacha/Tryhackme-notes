Inhalt für web-pentesting/race-conditions.md

# 🏁 Race Conditions

Race Conditions treten auf, wenn mehrere Prozesse gleichzeitig auf dieselbe Ressource zugreifen – und dadurch Sicherheitslücken entstehen.

---

## 🧠 Was ist eine Race Condition?

Ein System prüft z. B. Berechtigungen, bevor es etwas ausführt.  
Wenn zwischen „Prüfen“ und „Ausführen“ ein Zeitfenster liegt, kann ein Angreifer versuchen, das Verhalten zu beeinflussen.

### 🔄 Beispiel: TOCTOU (Time Of Check To Time Of Use)

1. System prüft, ob Datei X sicher ist
2. Kurz darauf führt es X aus

Angreifer: Tauscht in Millisekunden Datei X gegen etwas Böses aus

---

## 🎯 Angriffsziele

- Sicherheitsprüfung umgehen
- Datei-Upload manipulieren
- Admin-Rechte eskalieren
- Zwei-Bestellungen (z. B. doppelte Coupons)
- Mehrfach-Abheben vom Konto

---

## 🔧 Techniken

### 🔹 Multi-Request Angriffe

- Sende 20x denselben Request gleichzeitig
- Ziel: Wettbewerb zwischen Threads auf Server

Beispiel:
```bash
ffuf -X POST -d 'coupon=FREE50' -H "Content-Type: application/x-www-form-urlencoded" -w payloads.txt -u http://target.com/redeem

🔹 curl mit Parallelität

for i in {1..20}; do curl -X POST http://target.com/redeem & done

🔹 Upload-Race (Datei wird während des Scans ersetzt)

    Harmloses Bild hochladen

    In Sekunde zwischen „Upload“ und „Move“ die Datei durch PHP/Webshell ersetzen

🧪 Tools
Tool	Zweck
Burp Suite	Manuelles und paralleles Testing
Intruder (Turbo)	Multi-Thread Test
Turbo Intruder	Hochperformanter Parallelfuzzer
ffuf	Simpler CLI-basierter Angriff
🛡️ Schutzmaßnahmen

    Sperren von Ressourcen bei Prüfung

    Atomares Schreiben / Transaktionen

    Mehrfache Prüfungen statt nur vor Ausführung

    Rate-Limiting und Logging
